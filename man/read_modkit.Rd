% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/read_modkit.R
\name{read_modkit}
\alias{read_modkit}
\title{Read ModKit bedMethyl files and create methrix object}
\usage{
read_modkit(
  files,
  target_mod = "m",
  bin_size = 1000000L,
  quality_filter = 0.1,
  min_coverage = 1L,
  combine_strands = FALSE,
  ref_fasta = NULL,
  n_cores = 1L,
  h5 = FALSE,
  h5_dir = NULL,
  coldata = NULL,
  auto_index = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{files}{Character vector of ModKit bedMethyl file paths (.bed.gz with .tbi)}

\item{target_mod}{Target modification code: "m" (5mC), "h" (5hmC), "a" (6mA), "c" (5fC), "g" (5caC). Default "m".}

\item{bin_size}{Bin size for parallel processing in bases. Default 1000000.}

\item{quality_filter}{Maximum failure rate (0-1) per site. Default 0.1.}

\item{min_coverage}{Minimum coverage required per site. Default 1.}

\item{combine_strands}{Combine CpG strands for cytosine modifications? Default FALSE.}

\item{ref_fasta}{Optional reference FASTA file path (with .fai index) for context annotation.
When provided, adds 'ref_base' and 'context' columns to rowData with reference base
and sequence context (CG/CHG/CHH) information.}

\item{n_cores}{Number of cores for parallel processing. Default 1.}

\item{h5}{Store matrices as HDF5Arrays? Default FALSE.}

\item{h5_dir}{Directory for HDF5 storage. Default NULL.}

\item{coldata}{Optional DataFrame with sample metadata. If NULL, created from filenames.}

\item{auto_index}{Automatically create tabix indices for files missing .tbi files? Default TRUE.}

\item{verbose}{Print progress messages? Default TRUE.}
}
\value{
A methrix object containing the merged methylation data
}
\description{
Reads ModKit bedMethyl files using tabix streaming and creates a methrix object.
}
\details{
This function uses an optimized C implementation for merging ModKit
bedMethyl files. It automatically discovers chromosomes with data and uses
a streaming merge approach for memory efficiency. Requires BGziped bedmethyl files.
}
\examples{
\dontrun{
# Basic 5mC analysis
meth <- read_modkit(modkit_files, target_mod = "m")

# 6mA analysis with parallel processing
meth_6mA <- read_modkit(modkit_files, target_mod = "a", n_cores = 4)

# With reference genome context
meth_ctx <- read_modkit(modkit_files, target_mod = "m", 
                       ref_fasta = "genome.fa")

# High-performance with HDF5 storage
meth_h5 <- read_modkit(modkit_files, target_mod = "m", 
                      h5 = TRUE, n_cores = 8)
                      
# Disable automatic indexing if needed
meth <- read_modkit(modkit_files, auto_index = FALSE)
}

}
