% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_context.R
\name{add_context}
\alias{add_context}
\title{Add Reference Base and Sequence Context to Methrix Object}
\usage{
add_context(m, ref_fasta = NULL, bsgenome = NULL, verbose = TRUE)
}
\arguments{
\item{m}{A methrix object}

\item{ref_fasta}{Path to reference FASTA file (.fa or .fasta). Must have a .fai index
(create with `samtools faidx`). Required if `bsgenome` is not provided.}

\item{bsgenome}{A BSgenome object (e.g., BSgenome.Hsapiens.UCSC.hg38). Required if
`ref_fasta` is not provided.}

\item{verbose}{Print progress messages (default: TRUE)}
}
\value{
A methrix object with `ref_base` and `context` columns added to rowData
}
\description{
Adds reference base and sequence context information to an existing methrix object.
Supports both FASTA files and BSgenome objects as reference sources.
}
\details{
This function extracts the reference base and sequence context (CG, CHG, CHH)
for each CpG site in the methrix object and adds them to the rowData.

When using a FASTA file, the function uses efficient C code with 50KB chunk caching
for fast extraction.

When using a BSgenome object, the function extracts sequences using R/Bioconductor
functions.

The context is determined from a 3-base window starting at each position, with
reverse complement handling for minus strand sites.
}
\examples{
\dontrun{
# Using FASTA file
m <- read_modkit_v2(files = bedfiles, chrom_sizes = "hg38.chrom.sizes")
m <- add_context(m, ref_fasta = "hg38.fa")

# Using BSgenome
library(BSgenome.Hsapiens.UCSC.hg38)
m <- add_context(m, bsgenome = BSgenome.Hsapiens.UCSC.hg38)
}

}
